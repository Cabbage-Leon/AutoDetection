## 📝 TODO 列表

### 近期计划
- [x] 添加智能秒杀系统
- [ ] 添加更多 AI 模型支持（让电脑更"聪明"）
- [ ] 优化实时传输性能（让画面更流畅）
- [ ] 添加用户认证系统（防止别人偷看你的屏幕）
- [ ] 支持多显示器（让所有屏幕都变得"聪明"）

### 未来展望
- [ ] 添加语音控制功能（用说话来控制电脑）
- [ ] 支持手势识别（挥挥手就能控制）
- [ ] 添加自动截图功能（发现异常自动保存）
- [ ] 支持远程控制（让手机也能查看和控制）
- [ ] 验证码自动识别
- [ ] 多账号管理
- [ ] 秒杀成功率分析

# AutoDetection - 智能自动化检测系统

## 项目概述

AutoDetection 是一个集成了多种自动化功能的智能系统，包括 YOLO 目标检测、浏览器自动化、智能秒杀等功能。系统采用模块化设计，支持高并发、多任务并行处理。

## 功能模块

### 1. YOLO 目标检测模块
- 基于 YOLO 算法的实时目标检测
- 支持图片上传和实时检测
- 可视化检测结果展示

### 2. 浏览器自动化模块
- 网页自动化操作
- 元素定位和交互
- 支持多种选择器类型

### 3. 智能秒杀模块 ⭐ **最新优化**

#### 核心功能
- **多任务并行管理**：支持同时运行多个秒杀任务
- **智能时间同步**：支持北京时间/本地时间切换，NTP/HTTP时间同步
- **可视化元素选择**：支持CSS、XPath、文本、标签等多种选择器
- **实时状态监控**：任务状态、进度、成功率实时更新
- **智能操作控制**：启动、停止、重置、删除等操作

#### 新增优化功能 🚀

##### 1. 通用倒计时解析器
- **多格式支持**：时间格式（23:59:59）、文本格式（剩余10分钟）、数字格式（600秒）、混合格式（1天2小时30分钟）
- **智能识别**：自动识别和解析各种倒计时格式
- **阈值控制**：可设置倒计时阈值，精确控制执行时机
- **容错机制**：解析失败时提供详细错误信息

**支持的倒计时格式：**
```
时间格式: 23:59:59, 00:00:00, 59:59
文本格式: 剩余时间10分钟, 还有1小时, 10分钟后
数字格式: 600, 3600 (秒数)
混合格式: 1天2小时30分钟, 2小时15分钟
```

##### 2. 浏览器缓存优化
- **页面状态缓存**：避免每次任务执行都重新加载页面
- **智能复用机制**：相同URL的页面优先使用缓存
- **缓存超时控制**：可配置缓存过期时间（默认5分钟）
- **状态检查**：自动检查页面有效性，确保缓存可用

**性能提升：**
- 减少页面加载时间 70-90%
- 降低网络带宽消耗
- 提高任务执行效率

##### 3. 连续点击模式
- **点击模式选择**：单次点击 / 连续点击
- **次数控制**：可设置连续点击次数（1-100次）
- **间隔控制**：可设置点击间隔（0.01-10秒）
- **智能反馈**：显示点击成功率和详细结果

**应用场景：**
- 高并发秒杀场景
- 需要多次确认的操作
- 防止点击失效的备用方案

#### 任务配置参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `name` | string | - | 任务名称 |
| `url` | string | - | 目标URL |
| `target_selector` | string | - | 目标元素选择器 |
| `target_type` | string | - | 选择器类型 (css/xpath/text/tag) |
| `execution_time` | datetime | - | 执行时间 |
| `countdown_selector` | string | null | 倒计时元素选择器 |
| `countdown_type` | string | null | 倒计时选择器类型 |
| `countdown_threshold` | int | 0 | 倒计时阈值（秒） |
| `click_mode` | string | 'single' | 点击模式 (single/continuous) |
| `click_count` | int | 1 | 连续点击次数 |
| `click_interval` | float | 0.1 | 点击间隔（秒） |
| `frequency` | int | 1 | 执行频率（秒） |
| `max_attempts` | int | 10 | 最大尝试次数 |
| `timezone` | string | 'Asia/Shanghai' | 时区 |

#### API 接口

##### 任务管理
- `GET /seckill/api/tasks` - 获取所有任务
- `POST /seckill/api/tasks` - 创建新任务
- `GET /seckill/api/tasks/<task_id>` - 获取指定任务
- `PUT /seckill/api/tasks/<task_id>` - 更新任务
- `DELETE /seckill/api/tasks/<task_id>` - 删除任务

##### 任务控制
- `POST /seckill/api/tasks/<task_id>/start` - 启动任务
- `POST /seckill/api/tasks/<task_id>/stop` - 停止任务
- `POST /seckill/api/tasks/<task_id>/reset` - 重置任务

##### 浏览器操作
- `POST /seckill/api/browser/load-url` - 加载URL
- `POST /seckill/api/browser/find-elements` - 查找元素
- `POST /seckill/api/browser/click-element` - 点击元素
- `POST /seckill/api/browser/input-text` - 输入文本
- `POST /seckill/api/browser/page-info` - 获取页面信息

##### 时间同步
- `POST /seckill/api/time/sync` - 同步时间
- `GET /seckill/api/time/info` - 获取时间信息
- `POST /seckill/api/time/countdown` - 获取倒计时

##### 元素选择
- `POST /seckill/api/elements/generate-selectors` - 生成选择器
- `POST /seckill/api/elements/validate-selector` - 验证选择器

##### 调度器控制
- `GET /seckill/api/scheduler/status` - 获取调度器状态
- `POST /seckill/api/scheduler/start` - 启动调度器
- `POST /seckill/api/scheduler/stop` - 停止调度器

## 安装和运行

### 环境要求
- Python 3.8+
- Chrome 浏览器
- 足够的系统内存（建议4GB+）

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd AutoDetection
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **运行应用**
```bash
python run.py
```

4. **访问系统**
- 主页面: http://localhost:5000
- 秒杀模块: http://localhost:5000/seckill
- 任务管理: http://localhost:5000/seckill/task-manager
- 模拟Demo: http://localhost:5000/seckill/demo

## 使用指南

### 创建秒杀任务

1. **访问任务管理页面**
   - 打开 http://localhost:5000/seckill/task-manager

2. **配置任务参数**
   - 填写任务名称和目标URL
   - 设置执行时间和时区
   - 配置目标元素选择器
   - 选择点击模式（单次/连续）
   - 设置倒计时元素（可选）

3. **高级配置**
   - 倒计时阈值：设置倒计时小于等于此值时开始执行
   - 连续点击：设置点击次数和间隔
   - 执行频率：设置任务重试间隔
   - 最大尝试次数：设置任务最大重试次数

4. **启动任务**
   - 点击"启动"按钮开始执行
   - 实时监控任务状态和进度

### 倒计时配置示例

**场景1：标准时间格式**
```
倒计时选择器: .countdown-timer
选择器类型: css
倒计时阈值: 0
```
支持格式：`23:59:59`, `00:00:00`

**场景2：文本格式**
```
倒计时选择器: .remaining-time
选择器类型: css
倒计时阈值: 60
```
支持格式：`剩余时间10分钟`, `还有1小时`

**场景3：混合格式**
```
倒计时选择器: .time-left
选择器类型: css
倒计时阈值: 300
```
支持格式：`1天2小时30分钟`, `2小时15分钟`

### 连续点击配置示例

**高并发秒杀场景**
```
点击模式: continuous
连续点击次数: 5
点击间隔: 0.05
```

**防止点击失效**
```
点击模式: continuous
连续点击次数: 3
点击间隔: 0.2
```

## 技术架构

### 核心组件

1. **调度器 (Scheduler)**
   - 多任务并行管理
   - 智能时间控制
   - 任务状态管理

2. **浏览器管理器 (BrowserManager)**
   - 浏览器实例管理
   - 页面状态缓存
   - 智能页面复用

3. **倒计时解析器 (CountdownParser)**
   - 多格式倒计时解析
   - 智能时间识别
   - 阈值控制

4. **元素选择器 (ElementSelector)**
   - 多种选择器生成
   - 选择器验证
   - 可视化选择

5. **时间同步器 (TimeSync)**
   - NTP时间同步
   - HTTP时间同步
   - 时区转换

### 性能优化

1. **浏览器缓存**
   - 页面状态缓存减少加载时间
   - 智能复用机制提高效率
   - 缓存超时控制确保数据新鲜

2. **倒计时优化**
   - 通用解析器支持多种格式
   - 智能识别减少配置复杂度
   - 阈值控制精确执行时机

3. **点击优化**
   - 连续点击模式提高成功率
   - 间隔控制避免过度请求
   - 智能反馈提供执行状态

## 故障排除

### 常见问题

1. **页面加载失败**
   - 检查网络连接
   - 验证URL有效性
   - 确认浏览器实例状态

2. **元素查找失败**
   - 检查选择器是否正确
   - 确认页面是否完全加载
   - 验证元素是否存在

3. **倒计时解析失败**
   - 检查倒计时文本格式
   - 确认选择器是否正确
   - 查看日志获取详细错误

4. **任务执行失败**
   - 检查任务配置参数
   - 确认执行时间设置
   - 查看任务日志

### 日志查看

系统提供详细的日志记录，可通过以下方式查看：

1. **控制台日志**
   - 运行时的实时日志输出

2. **任务状态**
   - 任务管理页面的状态显示

3. **API响应**
   - 接口返回的详细错误信息

## 更新日志

### v2.0.0 (最新)
- ✅ 新增通用倒计时解析器
- ✅ 优化浏览器缓存机制
- ✅ 新增连续点击模式
- ✅ 改进任务执行效率
- ✅ 增强错误处理和日志

### v1.0.0
- ✅ 基础秒杀功能
- ✅ 任务管理系统
- ✅ 浏览器自动化
- ✅ 时间同步功能

## 贡献指南

欢迎提交 Issue 和 Pull Request 来改进项目。

## 许可证

本项目采用 MIT 许可证。 